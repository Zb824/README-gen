(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[35],{1390:function(e,t,i){},1391:function(e,t,i){},1548:function(e,t,i){"use strict";i(1390)},1549:function(e,t,i){"use strict";i(1391)},1630:function(e,t,i){"use strict";i.r(t);var n=i(212),o=i.n(n),r=i(104),a=i(24),s=i(335),d=i.n(s),l=i(22);function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach((function(t){_defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _defineProperty(e,t,i){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u={components:{videojsPlayer:()=>Promise.all([i.e(50),i.e(39)]).then(i.bind(null,1635)),shakaPlayer:()=>i.e(51).then(i.bind(null,1636)),hlsjsPlayer:()=>Promise.all([i.e(53),i.e(46)]).then(i.bind(null,1637)),FeedbackWidget:()=>i.e(47).then(i.bind(null,790))},props:{id:String,item:Object,statid:String,cta:Object,embed:Boolean},data(){return{iconMute:d.a,resetPosition:!0,videoIssue:null,feedbackSent:!1,feedbackTimeout:null,ended:!1,playing:!1,playingStarted:!1,playlistRetried:!1,pc_reported:0,pc_increment:0,playerOptions:{muted:this.autoplay,autoplay:this.autoplay,poster:this.posterURL,language:"en",controls:!0,liveui:!0,errorDisplay:!1,preload:"none",aspectRatio:this.embed?void 0:"16:9",fluid:!this.embed,fill:this.embed,playbackRates:[.5,1,1.2,1.5,1.7,2],controlBar:{pictureInPictureToggle:!0,children:["playToggle","progressControl","SeekToLive","remainingTimeDisplay","VolumeControl","PlaybackRateMenuButton","pictureInPictureToggle","fullscreenToggle"]},html5:{vhs:{nudgeMaxRetry:5,maxLoadingDelay:5,appendErrorMaxRetry:5}}}}},computed:_objectSpread(_objectSpread({},Object(l.b)(["user","features","featuresLoaded","itemOrganization","annotatedVideo"])),{},{canFeedbackVideo:function(){if(!this.playingStarted)return!1;if(this.feedbackSent)return!1;if(this.videoIssue&&!this.videoIssueShown)return this.videoIssueShown=!0,!0;if(!this.ended)return!1;const e=r.DateTime.fromISO(this.user.attributes.created_at),t=r.DateTime.now(),i=t.diff(e,"days").toObject().days;return parseInt(localStorage.getItem("lastSentSurveyInMonth"))!=t.month&&(!(i<14)&&(localStorage.setItem("lastSentSurveyInMonth",t.month),!0))},embedMode:function(){var e;return!(null===(e=this.$route.query)||void 0===e||!e.embed)},isOwner:function(){var e,t,i,n;return(null===(e=this.item.relationships)||void 0===e||null===(t=e.user)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.id)===(null===(n=this.user)||void 0===n?void 0:n.id)==!0},itemLoaded:function(){return this.item!=={}},posterURL:function(){var e,t;return null===(e=this.item)||void 0===e||null===(t=e.links)||void 0===t?void 0:t.poster_url},contentURL:function(){var e,t;return null===(e=this.item)||void 0===e||null===(t=e.links)||void 0===t?void 0:t.content_url},preferHls:function(){const e=this.$store.state.features["b485cdd9-6496-531a-bab4-90bdb7279800"],t=this.$route.query.nohls;return this.$route.query.hls||!t&&e},sourceURL:function(){return this.annotatedVideo?this.annotatedVideo:this.preferHls?(null===(e=this.item.links)||void 0===e?void 0:e.hls_url)||(null===(t=this.item.links)||void 0===t?void 0:t.content_url):null===(i=this.item.links)||void 0===i?void 0:i.content_url;var e,t,i},autoplay:function(){return!!navigator.userAgent.includes("Slack")||(this.embedMode?void 0!==(null===(e=this.$route.query)||void 0===e?void 0:e.autoplay):!!(null!==(t=this.$route.query)&&void 0!==t&&t.autoplay||null!==(i=this.features)&&void 0!==i&&i["42054bc2-121c-54e0-a6f1-bf4fb0224f25"]));var e,t,i},pcIncrement(){if(this.pc_increment)return this.pc_increment;let e=videojs("#video-item");if(null==e||!e.duration())return NaN;let t=.05*e.duration(),i=Math.min(Math.max(t,3),30);return this.pc_increment=Math.floor(i/e.duration()*100)},videoPlayerName:function(){var e,t,i;if(null!==(e=this.$route.query)&&void 0!==e&&e.player)return null===(t=this.$route.query)||void 0===t?void 0:t.player;const n=null===(i=this.item)||void 0===i?void 0:i.attributes,o=this.features;if(!n)return;if(!this.featuresLoaded)return;const r=n.instant_video;return(this.preferHls||r)&&o["30b89352-1595-53db-8b24-83191e9418e4"]?o["30b89352-1595-53db-8b24-83191e9418e4"]:"videojs"}}),watch:{sourceURL:{immediate:!0,handler:function(e){this.$refs.videoPlayer&&"function"==typeof this.$refs.videoPlayer.setSource?this.$refs.videoPlayer.setSource(e,this.posterURL):this.playerOptions.sources=[{src:e}]}},videoPlayerName:{immediate:!0,handler:function(e){console.debug(`videoPlayerName watcher: ${e}`)}},itemLoaded:{immediate:!0,handler(e){if(e){const e=this;if(window.chrome){let t;e.$nextTick((()=>{new ResizeObserver((i=>{const n=i[0],o=document.getElementsByTagName("body")[0],r=o.clientHeight>window.innerHeight,a=o.clientHeight-window.innerHeight;r&&a<20?e.$refs.videoContainer.style.maxWidth=`${t}px`:t=Math.floor(n.contentRect.width)})).observe(e.$refs.videoContainer)}))}e.$set(e.playerOptions,"autoplay",e.autoplay),e.$set(e.playerOptions,"muted",e.autoplay),e.$set(e.playerOptions,"poster",e.posterURL)}}}},methods:{zoomImage(){this.$parent.$parent.zoomImage()},setMinHeightWidth(){this.$parent.$parent.setMinHeightWidth&&this.$parent.$parent.setMinHeightWidth()},updateItemStat:function(e,t){if(!this.isOwner&&""!=this.statid){let i=this.statid,n={itemId:this.item.id,params:{stat_id:i,viewed_pc:e,length:t}};this.$store&&this.$store.dispatch("updateStats",n)}},percentViewed:function(){let e=videojs("#video-item");if(isNaN(e.duration()))return 0;let t=e.played(),i=0;for(let e=0;e<t.length;++e)i+=t.end(e)-t.start(e);return i/e.duration()*100},onMetadata:function(){let e=videojs("#video-item"),t=this.iconMute;if(this.resetPosition&&(e.currentTime(0),this.resetPosition=!1),!this.embed&&e.muted()){var i=document.createElement("img"),n=this.$refs.videoContainer;i.addEventListener("click",(function(){e.muted(!1),n.removeChild(i)})),i.setAttribute("src",t),i.classList.add("icon-muted"),n.appendChild(i)}},onTimeUpdate:function(){if(!this.isOwner){let e=videojs("#video-item"),t=this.percentViewed(),i=this.pc_reported+this.pcIncrement,n=i>100?100:i;if(t>this.pc_reported&&t>=n){let i=t-t%this.pcIncrement;this.pc_reported=100==t?100:i,this.updateItemStat(t,e.duration())}}},onReady:function(){const e=videojs("#video-item");this.embed&&this.autoplay&&(e.play(),e.muted(!1))},onEnded:function(){this.ended=!0,this.$emit("videoEnded",!0)},onError:function(e){const t=videojs("#video-item");console.warn(`Player error: ${t.error()}`);let i=this.item.id,n=t.error();this.videoIssue="unplayable_video_viewed",Object(a.a)("unplayable_video_viewed",{hashid:i,embed:this.embed,error:{code:n.code,type:n.type,message:n.message}})},onPlay:function(e){this.ended=!1,this.playing=!0,this.videoIssue=null,this.$emit("videoEnded",!1)},onPause:function(){this.feedbackTimeout&&clearTimeout(this.feedbackTimeout)},onPlaying:function(){this.playing=!0,this.videoIssue=null,this.playlistRetried=!1,this.feedbackTimeout&&clearTimeout(this.feedbackTimeout)},onWaiting:function(){const e=this;e.playing=!1,e.feedbackTimeout&&clearTimeout(e.feedbackTimeout),e.feedbackTimeout=setTimeout((function(){e.playing||(e.videoIssue="videojs_waiting")}),1e4)},onRetryplaylist:function(){const e=this;e.playing=!1,e.playlistRetried||(e.playlistRetried=!0,clearTimeout(e.feedbackTimeout),e.feedbackTimeout=setTimeout((function(){e.playing||(e.videoIssue="videojs_retry_playlist",Object(a.a)(e.videoIssue,{hashid:e.item.id,user_agent:window.navigator.userAgent,is_hls:e.item.attributes.is_hls,transcoded:"succeeded"==e.item.transcode_status}))}),1e4))},onFirstplay:function(){this.playingStarted=!0,Object(a.a)("video_play_click",{hashid:this.$root.item.id,viewer:"dropper"})},onStalled:function(){const e=this;e.playing=!1,e.feedbackTimeout&&clearTimeout(e.feedbackTimeout),e.feedbackTimeout=setTimeout((function(){e.playing||(e.videoIssue="videojs_stalled")}),1e4)},sendVideoFeedback:function(e){const t=new o.a(navigator.userAgent).getBrowser(),i=this;let n={score:e.score,comment:e.comment,plan:i.itemOrganization.attributes.plan_name,email:i.user.attributes.email,is_owner:i.isOwner,anonymous:!i.user.id,hashid:i.item.id,source_app:i.item.attributes.client_version,user_agent:`${t.name} ${t.version}`};i.videoIssue&&(n.source=i.videoIssue),setTimeout((()=>i.feedbackSent=!0),1e3),Object(a.a)("video_review",n)}}},c=(i(1548),i(1549),i(15)),p=Object(c.a)(u,(function render(){var e=this,t=e._self._c;return e.itemLoaded?t("div",{ref:"videoContainer",class:{embedded:e.embed},staticStyle:{position:"relative",width:"100%"},attrs:{id:"video-item-container"}},["videojs"===e.videoPlayerName||"hlsjs"===e.videoPlayerName?t("videojs-player",{ref:"videoPlayer",staticClass:"w-100 h-100 vjs-default-skin vjs-big-play-centered vjs-show-big-play-button-on-pause",attrs:{options:e.playerOptions,tech:e.videoPlayerName,captionsUrl:e.item.links.captions_url},on:{loadedmetadata:e.onMetadata,ended:e.onEnded,error:e.onError,timeupdate:e.onTimeUpdate,stalledVideo:e.onStalled,videoWaiting:e.onWaiting,retryplaylist:e.onRetryplaylist,firstplay:e.onFirstplay,ready:e.onReady,play:e.onPlay,pause:e.onPause,playing:e.onPlaying}}):"shaka"===e.videoPlayerName?t("shaka-player",{ref:"videoPlayer",staticClass:"w-100 h-100",attrs:{item:e.item,options:e.playerOptions},on:{loadedmetadata:e.onMetadata,ended:e.onEnded,error:e.onError,timeupdate:e.onTimeUpdate,ready:e.onReady,play:e.onPlay}}):"hlsjsdirect"===e.videoPlayerName?t("hlsjs-player",{ref:"videoPlayer",staticClass:"w-100 h-100",attrs:{native:!1,src:e.contentURL}}):e._e(),e._v(" "),t("feedback-widget",{attrs:{show:e.canFeedbackVideo},on:{submit:e.sendVideoFeedback}},[e._v("\n    "+e._s(e.videoIssue?"How would you rate this experience?":"How was the quality of this video?")+"\n  ")])],1):e._e()}),[],!1,null,"099a4c7b",null);t.default=p.exports},24:function(e,t,i){"use strict";var n=i(14);t.a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.default.post("/tracking",{event:e,properties:t})}},335:function(e,t){e.exports="//public.getcloudapp.com/packs/media/images/icon-muted-015c9d8bdb24f1781d8700e7122627a8.svg"}}]);
//# sourceMappingURL=35-e4bdd15e0b65ad16abfa.chunk.js.map